!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},o=(e,t,o)=>{const n=e.querySelector(`#${t.id}-error`);t.classList.remove(o.inputErrorClass),n.textContent=""},n=(e,t,o)=>{(e=>e.some((e=>!e.validity.valid)))(e)?((e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)})(t,o):(t.classList.remove(o.inactiveButtonClass),t.disabled=!1)};var r=e+"80804e27ce061efd1ffb.svg",s=e+"2fc47fd8e9a9bcd9612f.jpg",a=e+"3f562ce83766a824571e.svg",c=e+"975792ea68af0a3c209d.svg";const l=document.getElementById("image-logo"),i=document.getElementById("image-avatar"),m=document.getElementById("image-pencil_icon"),u=document.getElementById("image-plus_icon");l.src=r,i.src=s,m.src=a,u.src=c;const d=document.querySelector("#preview-modal"),p=(d.querySelector(".modal__close-btn"),d.querySelector(".modal__image")),_=d.querySelector(".modal__caption"),f=document.querySelector("#post-template"),y=document.querySelector(".posts__list");function v(e){const t=f.content.querySelector(".post").cloneNode(!0),o=t.querySelector(".post__image"),n=t.querySelector(".post__text");o.src=e.link,n.textContent=e.name,o.alt=e.name;const r=t.querySelector(".post__like-btn");return r.addEventListener("click",(()=>{r.classList.toggle("post__like-btn_clicked")})),t.querySelector(".post__delete-btn").addEventListener("click",(()=>{t.remove()})),o.addEventListener("click",(()=>{q(d),p.src=o.src,p.alt=o.alt,_.textContent=n.textContent})),t}document.querySelectorAll(".modal__submit-btn"),[{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Golden Gate Bridge",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"}].forEach((e=>{const t=v(e);y.append(t)}));const g=document.querySelector(".main"),S=[...document.querySelectorAll(".modal")],b=document.querySelectorAll(".modal__close-btn");function q(e){e.classList.remove("modal_closed"),document.addEventListener("keydown",E)}function h(e){e.classList.add("modal_closed"),document.removeEventListener("keydown",E)}function E(e){S.forEach((t=>{"Escape"===e.key&&h(t)}))}S.forEach((e=>{e.addEventListener("click",(t=>{t.target.classList.contains("modal")&&h(e)}))})),b.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>h(t)))}));const w=document.querySelector("#edit-modal"),k=document.querySelector(".profile__edit-btn"),L=(w.querySelector(".modal__close-btn"),g.querySelector(".profile__name")),x=g.querySelector(".profile__description"),C=w.querySelector("#profile-name-input"),B=w.querySelector("#profile-description-input"),z=w.querySelector(".modal__form");var A;k.addEventListener("click",(()=>{var e,n;C.value=L.textContent,B.value=x.textContent,q(w),e=w,n=t,[C,B].forEach((t=>{o(e,t,n)}))})),A=t,Array.from(document.querySelectorAll(A.formSelector)).forEach((e=>{((e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector)),s=e.querySelector(t.submitButtonSelector);n(r,s,t),r.forEach((a=>{a.addEventListener("input",(function(){n(r,s,t),((e,t,n)=>{t.validity.valid?o(e,t,n):((e,t,o,n)=>{const r=e.querySelector(`#${t.id}-error`);t.classList.add(n.inputErrorClass),r.textContent=o})(e,t,t.validationMessage,n)})(e,a,t)}))}))})(e,A)})),z.addEventListener("submit",(e=>{var o;o=e,L.textContent=C.value,x.textContent=B.value,o.preventDefault(),h(w),disableButton(o.submitter,t)}));const j=document.querySelector("#post-modal"),I=document.querySelector(".profile__post-btn"),D=(j.querySelector(".modal__close-btn"),j.querySelector(".modal__form")),G=j.querySelector("#image-link"),M=j.querySelector("#caption");I.addEventListener("click",(()=>{q(j)})),D.addEventListener("submit",(e=>{!function(e){e.preventDefault(),disableButton(e.submitter,t),h(j);const o=v({link:G.value,name:M.value});y.prepend(o),e.target.reset()}(e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VXdDLEVBQWEsSUFvQnpCRSxFQUFrQjVDLGlCQUFpQixVQUFXK0MsS0FqQjlDLFNBQXVCUixHQUNyQkEsRUFBTUMsaUJBRU50RSxjQUFjcUUsRUFBTUUsVUFBVy9GLEdBRS9CbUUsRUFBVzZCLEdBQ1gsTUFLTU0sRUFBZ0IzRCxFQUxOLENBQ2RPLEtBQU1pRCxFQUFVZixNQUNoQmpDLEtBQU1pRCxFQUFRaEIsUUFJaEIxQyxFQUFVNkQsUUFBUUQsR0FFbEJULEVBQU10QixPQUFPaUMsT0FDZixDQUdFQyxDQUFjSixFQUFZLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJjb25zdCBzZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ0bl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICAvLyBjb25zb2xlLmxvZyhjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgLy8gY29uc29sZS5sb2coY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxufTtcclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoXHJcbiAgICAgIGZvcm1FbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQsXHJcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcclxuICAgICAgY29uZmlnXHJcbiAgICApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgLy8gY29uc29sZS5sb2coY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcclxuICAvLyAgIGNvbnNvbGUubG9nKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKTtcclxuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBjb25maWcpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcilcclxuICApO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuXHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICAvLyBmb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgIC8vICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAvLyB9KTtcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLy8gZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XHJcblxyXG5leHBvcnQgeyBzZXR0aW5ncywgZW5hYmxlVmFsaWRhdGlvbiwgcmVzZXRWYWxpZGF0aW9uIH07XHJcbiIsIi8vQUREIEZBS0UgQ09NTUVOVCBGT1IgUFJPSkVDVCA5IEJSQU5DSFxyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQge1xyXG4gIHNldHRpbmdzLFxyXG4gIGVuYWJsZVZhbGlkYXRpb24sXHJcbiAgcmVzZXRWYWxpZGF0aW9uLFxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcclxuXHJcbmltcG9ydCBsb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIjtcclxuaW1wb3J0IGF2YXRhclNyYyBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcclxuaW1wb3J0IHBlbmNpbEljb25TcmMgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWxfaWNvbi5zdmdcIjtcclxuaW1wb3J0IHBsdXNJY29uU3JjIGZyb20gXCIuLi9pbWFnZXMvcGx1c19pY29uLnN2Z1wiO1xyXG5cclxuY29uc3QgbG9nb0ltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbWFnZS1sb2dvXCIpO1xyXG5jb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2UtYXZhdGFyXCIpO1xyXG5jb25zdCBwZW5jaWxJY29uSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLXBlbmNpbF9pY29uXCIpO1xyXG5jb25zdCBwbHVzSWNvbkltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbWFnZS1wbHVzX2ljb25cIik7XHJcblxyXG5sb2dvSW1hZ2Uuc3JjID0gbG9nb1NyYztcclxuYXZhdGFySW1hZ2Uuc3JjID0gYXZhdGFyU3JjO1xyXG5wZW5jaWxJY29uSW1hZ2Uuc3JjID0gcGVuY2lsSWNvblNyYztcclxucGx1c0ljb25JbWFnZS5zcmMgPSBwbHVzSWNvblNyYztcclxuXHJcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbCBUaG9yZW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbmFtZTogXCJSZXN0YXVyYW50IHRlcnJhY2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbmFtZTogXCJBIHZlcnkgbG9uZyBicmlkZ2UsIG92ZXIgdGhlIGZvcmVzdCBhbmQgdGhyb3VnaCB0aGUgdHJlZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICBuYW1lOiBcIkdvbGRlbiBHYXRlIEJyaWRnZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzctcGhvdG8tYnktZ3JpZmZpbi13b29sZHJpZGdlLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBQUkVWSUVXIFtJTUFHRV0gTU9EQUwgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IG1vZGFsSW1hZ2UgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmNvbnN0IG1vZGFsQ2FwdGlvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gTE9BRCBQT1NUUyBPTlRPIFBBR0UgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3N0LXRlbXBsYXRlXCIpO1xyXG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvc3RzX19saXN0XCIpO1xyXG5jb25zdCBtb2RhbFN1Ym1pdEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoaW5pdGlhbENhcmQpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5wb3N0XCIpXHJcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAvLyBzZWxlY3QgdGhlIGNhcmQgdGl0bGUgYW5kIGltYWdlIGFuZCBzdG9yZSB0aGVtIGluIHZhcmlhYmxlc1xyXG4gIC8vIHNldCB0aGUgaW1hZ2XigJlzIHNyYyBhdHRyaWJ1dGUgdG8gdGhlIGltYWdlIHRvIHRoZSBsaW5rIGZpZWxkIG9mIHRoZSBvYmplY3RcclxuICBjb25zdCBjYXJkRWxlbWVudEltYWdlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3N0X19pbWFnZVwiKTtcclxuICBjb25zdCBjYXJkRWxlbWVudFRleHQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvc3RfX3RleHRcIik7XHJcblxyXG4gIC8vIHNldCB0aGUgaW1hZ2XigJlzIHNyYyBhdHRyaWJ1dGUgdG8gdGhlIGltYWdlIHRvIHRoZSBsaW5rIGZpZWxkIG9mIHRoZSBvYmplY3RcclxuICAvLyBzZXQgdGhlIGltYWdl4oCZcyBhbHQgdGV4dCB0byB0aGUgbmFtZSBmaWVsZCBvZiB0aGUgb2JqZWN0XHJcbiAgLy8gc2V0IHRoZSBjYXJk4oCZcyB0aXRsZSB0byB0aGUgbmFtZSBmaWVsZCBvZiB0aGUgb2JqZWN0LCB0b29cclxuICBjYXJkRWxlbWVudEltYWdlLnNyYyA9IGluaXRpYWxDYXJkLmxpbms7XHJcbiAgY2FyZEVsZW1lbnRUZXh0LnRleHRDb250ZW50ID0gaW5pdGlhbENhcmQubmFtZTtcclxuICBjYXJkRWxlbWVudEltYWdlLmFsdCA9IGluaXRpYWxDYXJkLm5hbWU7XHJcblxyXG4gIC8vRnVuY3Rpb24gdG8gY2hhbmdlIENTUyBvbiAnaGVhcnQtc2hhcGVkJyBMaWtlIEljb24gZm9yIGVhY2ggcG9zdC5cclxuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9zdF9fbGlrZS1idG5cIik7XHJcbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJwb3N0X19saWtlLWJ0bl9jbGlja2VkXCIpO1xyXG4gIH0pO1xyXG5cclxuICAvL01ha2UgVHJhc2ggQ2FuIGljb24gZGVsZXRlIHRoZSByZXNwZWN0aXZlIHBvc3QuXHJcbiAgY29uc3QgcG9zdERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9zdF9fZGVsZXRlLWJ0blwiKTsgLy8gTUFZIE5FRUQgVE8gQ0hBTkdFIFdIRVJFIFRIRSBRVUVSWSBTRUxFQ1RPUiBTVEFSVFNcclxuICBwb3N0RGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICB9KTtcclxuXHJcbiAgLy9DbGljayBFdmVudCBhbnl3aGVyZSBvbiB0aGUgcG9zdF9faW1hZ2Ugd2lsbCBvcGVuIHRoZSBwcmV2aWV3LW1vZGFsIHRvIGJldHRlciB2aWV3IHRoZSBwaWN0dXJlLlxyXG4gIGNhcmRFbGVtZW50SW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG4gICAgbW9kYWxJbWFnZS5zcmMgPSBjYXJkRWxlbWVudEltYWdlLnNyYztcclxuICAgIG1vZGFsSW1hZ2UuYWx0ID0gY2FyZEVsZW1lbnRJbWFnZS5hbHQ7XHJcbiAgICBtb2RhbENhcHRpb24udGV4dENvbnRlbnQgPSBjYXJkRWxlbWVudFRleHQudGV4dENvbnRlbnQ7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhwcmV2aWV3TW9kYWwuY2xhc3NMaXN0KTtcclxuICB9KTtcclxuXHJcbiAgLy8gcmV0dXJuIHRoZSByZWFkeSBIVE1MIGVsZW1lbnQgd2l0aCB0aGUgZmlsbGVkLWluIGRhdGFcclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbmluaXRpYWxDYXJkcy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgY29uc3QgY2FyZFJlc3VsdCA9IGdldENhcmRFbGVtZW50KGVsZW1lbnQpO1xyXG4gIC8vIFVzZSB0aGUgYXBwcm9wcmlhdGUgYnVpbHQtaW4gRE9NIG1ldGhvZCB0byBhZGQgdGhpcyBIVE1MIGVsZW1lbnQgdG8gdGhlIHBhZ2UuXHJcbiAgY2FyZHNMaXN0LmFwcGVuZChjYXJkUmVzdWx0KTtcclxufSk7XHJcblxyXG4vLyBPTEQgRk9SIExPT1AgVEhBVCBXQVMgUkVNT1ZFRCBGT1IgVEhFIEZPUkVBQ0ggQVJSQVkgRlVOQ1RJT04uXHJcbi8vICBmb3IgKGxldCBpID0gMDsgaSA8IGluaXRpYWxDYXJkcy5sZW5ndGg7IGkrKykge1xyXG4vLyAgIGNhcmRSZXN1bHQgPSBnZXRDYXJkRWxlbWVudChpbml0aWFsQ2FyZHNbaV0pO1xyXG4vLyAgIC8vIFVzZSB0aGUgYXBwcm9wcmlhdGUgYnVpbHQtaW4gRE9NIG1ldGhvZCB0byBhZGQgdGhpcyBIVE1MIGVsZW1lbnQgdG8gdGhlIHBhZ2UuXHJcbi8vICAgY2FyZHNMaXN0LmFwcGVuZChjYXJkUmVzdWx0KTtcclxuLy8gfVxyXG5cclxuLyogVE8gRE8gVEFTSyAyIE9GIDc6XHJcbi0gRE9ORSBJIG5lZWQgdG8gJ2ludmVydCcgbXkgZnVuY3Rpb25zLiBJIGN1cnJlbnRseSBoYXZlIHRoZSBmaWxsUHJvZmlsZUZvcm0gZnVuYyB0dWNrZWQgaW5zaWRlIHRoZSBvcGVuTW9kYWwgZnVuYywgYnV0IGl0IHNob3VsZCBiZSB0aGUgb3Bwb3NpdGUuXHJcbi0gRE9ORSBJbnZlcnRpbmcgdGhlIGZ1bmMncyB3aWxsIGFsbG93IG1lIHRvIHVzZSBvcGVuTW9kYWwgaW4gYW55IGZpbGwneCdGb3JtIGZ1bmMgLSBsaWtlIHRoZSBOZXcgUG9zdCBGb3JtIHRoYXQgbmVlZHMgYSBmdW5jIHRvIG9wZW4gYW5kIGNsb3NlIHN0aWxsLlxyXG4tIERPTkUgQWZ0ZXIgY2hlY2tpbmcgdGhhdCB0aGlzIHdvcmtzIHdpdGggdGhlIG9wZW5Nb2RhbCBmdW5jLCBpbnZlcnQgdGhlIGZ1bmNzIGZvciB0aGUgY2xvc2VNb2RhbC5cclxuLSBJIHdhcyBhYmxlIHRvIGFic3RyYWN0IHRoZSBvcGVuIE1vZGFsIGZhaXJseSBlYXNpbHksIGJ1dCB0aGUgY2xvc2UgTW9kYWwgaXMga2lja2luZyBteSBidXR0LiBJIHNpbmNlIHRoZXJlIGFyZSB0d28gZGlmZmVyZW50IGRpdidzIHdpdGggLm1vZGFsIGNsYXNzLFxyXG5JIGltYWdpbmUgSSBuZWVkIHRvIHJ1biBkb3duIHRoZSAnbGlzdCcgb2YgdGhlIHR3byBkaXYncywgc2VhcmNoIGlmIC5tb2RhbF9jbG9zZWQgY2xhc3MgaXMgYWN0aXZlIChvciByZW1vdmVkPyksIHRoZW4gcmV0dXJuIHRoZSAubW9kYWxbaV0gdG8gcGFzcyB0aGUgY2xvc2UtYnRuIGV2ZW50IGZ1bmN0aW9uIHRvIHRoZSBjb3JyZWN0IG1vZGFsLlxyXG4qL1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gQUxMIE1PREFMUyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5jb25zdCBtYWluU2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpblwiKTtcclxuY29uc3QgbW9kYWxzID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIildO1xyXG5jb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfY2xvc2VkXCIpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XHJcbiAgLy8gY29uc29sZS5sb2cobW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfY2xvc2VkXCIpO1xyXG4gIC8vIGNvbnNvbGUubG9nKG1vZGFsKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XHJcbiAgbW9kYWxzLmZvckVhY2goKG1vZGFsKSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICBjbG9zZU1vZGFsKG1vZGFsKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxubW9kYWxzLmZvckVhY2goKG1vZGFsKSA9PiB7XHJcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XHJcbiAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KTtcclxuXHJcbi8vVGhhbmsgeW91IGNvZGUgcmV2aWV3ZXIgYXMgdGhpcyBibGV3IG15IG1pbmQhIEkga25ldyBJIHdhcyB1c2luZyB0aGUgSW5kZXhlcyB3cm9uZywgYnV0IHRoZSBwaWVjZSBvZiB0aGUgJ3B1enpsZScgSSB3YXMgbWlzc2luZyB3YXMgdGhlIC5jbG9zZXN0IG9mIHRoZSBtb2RhbCBjbGFzcy5cclxuY2xvc2VCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xyXG4gIGNvbnN0IHBvcHVwID0gYnV0dG9uLmNsb3Nlc3QoXCIubW9kYWxcIik7XHJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKHBvcHVwKSk7XHJcbn0pO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gRURJVCBQUk9GSUxFIE1PREFMID09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgZWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XHJcbmNvbnN0IGVkaXRNb2RhbENsb3NlQnRuID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBtYWluU2VjdGlvbi5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjID0gbWFpblNlY3Rpb24ucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgbmV3UHJvZmlsZU5hbWUgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IG5ld1Byb2ZpbGVEZXNjID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZUZvcm0gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuXHJcbmVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBuZXdQcm9maWxlTmFtZS52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIG5ld1Byb2ZpbGVEZXNjLnZhbHVlID0gcHJvZmlsZURlc2MudGV4dENvbnRlbnQ7XHJcbiAgb3Blbk1vZGFsKGVkaXRNb2RhbCk7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKGVkaXRNb2RhbCwgW25ld1Byb2ZpbGVOYW1lLCBuZXdQcm9maWxlRGVzY10sIHNldHRpbmdzKTtcclxufSk7XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcclxuXHJcbmZ1bmN0aW9uIHN1Ym1pdFByb2ZpbGVGb3JtKGV2ZW50KSB7XHJcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuZXdQcm9maWxlTmFtZS52YWx1ZTtcclxuICBwcm9maWxlRGVzYy50ZXh0Q29udGVudCA9IG5ld1Byb2ZpbGVEZXNjLnZhbHVlO1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY2xvc2VNb2RhbChlZGl0TW9kYWwpO1xyXG4gIC8vIGRpc2FibGVCdXR0b24obW9kYWxTdWJtaXRCdG5zKTtcclxuICBkaXNhYmxlQnV0dG9uKGV2ZW50LnN1Ym1pdHRlciwgc2V0dGluZ3MpO1xyXG59XHJcblxyXG5wcm9maWxlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChwcm9maWxlRGF0YSkgPT4ge1xyXG4gIHN1Ym1pdFByb2ZpbGVGb3JtKHByb2ZpbGVEYXRhKTtcclxufSk7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBORVcgUE9TVCBNT0RBTCA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5jb25zdCBuZXdQb3N0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Bvc3QtbW9kYWxcIik7XHJcbmNvbnN0IG5ld1Bvc3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3Bvc3QtYnRuXCIpO1xyXG5jb25zdCBuZXdQb3N0TW9kYWxDbG9zZUJ0biA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IHN1Ym1pdE5ld1Bvc3RGb3JtID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGltYWdlTGluayA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLWxpbmtcIik7XHJcbmNvbnN0IGNhcHRpb24gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXB0aW9uXCIpO1xyXG5cclxubmV3UG9zdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG9wZW5Nb2RhbChuZXdQb3N0TW9kYWwpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHN1Ym1pdE5ld1Bvc3QoZXZlbnQpIHtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBkaXNhYmxlQnV0dG9uKGV2ZW50LnN1Ym1pdHRlciwgc2V0dGluZ3MpO1xyXG4gIC8vIGRpc2FibGVCdXR0b24obW9kYWxTdWJtaXRCdG5zKTtcclxuICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XHJcbiAgY29uc3QgbmV3Q2FyZCA9IHtcclxuICAgIGxpbms6IGltYWdlTGluay52YWx1ZSxcclxuICAgIG5hbWU6IGNhcHRpb24udmFsdWUsXHJcbiAgfTtcclxuXHJcbiAgY29uc3QgbmV3Q2FyZFJlc3VsdCA9IGdldENhcmRFbGVtZW50KG5ld0NhcmQpO1xyXG4gIGNhcmRzTGlzdC5wcmVwZW5kKG5ld0NhcmRSZXN1bHQpO1xyXG4gIC8vUmVtb3ZlIHZhbHVlcyB0byBlbnN1cmUgUGxhY2Vob2xkZXIgdGV4dCByZWFwcGVhcnMgZWFjaCB0aW1lIHRoZSAnTmV3IFBvc3QnIGJ1dHRvbiBpcyBjbGlja2VkLlxyXG4gIGV2ZW50LnRhcmdldC5yZXNldCgpO1xyXG59XHJcblxyXG5zdWJtaXROZXdQb3N0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChuZXdQb3N0RGF0YSkgPT4ge1xyXG4gIHN1Ym1pdE5ld1Bvc3QobmV3UG9zdERhdGEpO1xyXG4gIC8vIExpbmsgdG8gYW4gaW1hZ2UgZm9ybSB1bnNwbGFzaC5jb20gdGhhdCBJIHVzZWQgdG8gZW5zdXJlIGV2ZXJ5dGhpbmcgd29ya3MgcHJvcGVybHk6XHJcbiAgLy8gaHR0cHM6Ly9wbHVzLnVuc3BsYXNoLmNvbS9wcmVtaXVtX3Bob3RvLTE3MzQ1NDM5NDI4MzYtM2Y5YTBjMzEzZGE0P3c9NTAwJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnE9NjAmaXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHhtWldGMGRYSmxaQzF3YUc5MGIzTXRabVZsWkh3eGZIeDhaVzU4TUh4OGZIeDhcclxufSk7XHJcblxyXG4vKiBUQVNLIDMvNyBUTyBETzpcclxuLSBET05FIGNvcHkgdGhlIGVkaXRQcm9maWxlJ3MgU3VibWl0Rm9ybSBsaW5lcyBvZiBjb2RlIHRvIHRoZSBOZXcgUG9zdCBNb2RhbCBzZWN0aW9uLiBUd2VhayB0aGUgY29waWVkIGxpbmVzIHRvIHdvcmsgZm9yIHRoZSBOZXcgUG9zdCBNb2RhbCdzICdzdWJtaXQnIGJ1dHRvbi5cclxuLSBET05FIGFkanVzdCB0aGUgZWRpdFByb2ZpbGUncyBzdWJtaXRmb3JtIGNvZGUgdG8gd29yayB3aXRoIHRoZSBhcnJheSBvZiBxdWVyeVNlbGVjdG9yQWxsIGZvciBib3RoIHN1Ym1pdCBidG5zLiBTaW1pbGFyIHRvIGhvdyBJIGRpZCB0aGUgQ2xvc2VCdG4gZm9yIGJvdGggTW9kYWxzLlxyXG4tIERPTkUgcHJlcGVuZCB0aGUgY2FyZCBVUkwgYW5kIGRlc2NyaXB0aW9ucyB0byB0aGUgZnJvbnQgb2YgdGhlIGNhcmRzQXJyYXkgKHdoYXRldmVyIHRoZSBuYW1lIG9mIHRoZSBuZXcgYXJyYXkgd2lsbCBiZSkuXHJcbiovXHJcblxyXG4vKiBUQVNLIDQvNyBUTyBETzpcclxuLSBET05FIHNldCBsaXN0ZW5lciBmb3IgbGlrZSBidG4uIFBhc3MgaXQgdGhyb3VnaCBnZXRDYXJkRWxlbWVudCBmdW5jdGlvbiB0byBlbnN1cmUgZWFjaCBjYXJkIGdldHMgdGhlIGxpc3RlbmVyLlxyXG4tIERPTkUgY29uc29sZS5sb2cgdG8gZW5zdXJlIGxpc3RlbmVyIHdvcmtzIG9uIGVhY2ggbGlrZSBidG4uXHJcbi0gRE9ORSBtYWtlIENTUyBmb3Igd2hlbiBMaWtlIGJ0biBpcyBjbGlja2VkLiBFbnN1cmUgaXQncyBGaWdtYSdzIGRlc2lnbmF0ZWQgcmVkIGNvbG9yLlxyXG4tIERPTkUgbWFrZSBDU1M6aG92ZXIgZm9yIHdoZW4gYSAnbGlrZWQnIGJ0biBpcyBob3ZlcmVkIG92ZXIuXHJcbi0gRE9ORSB1cGRhdGUgbGlzdGVuZXIgZnVuYyB0byBjaGFuZ2UvYWRkIENTUyBjbGFzc2VzIHRvIGxpa2UgYnRuIHdoZW4gcHJlc3NlZC5cclxuLSBhZGQgZGVsZXRlIGljb24gaW50byBnZXRDYXJkRWxlbWVudCBmdW5jIHNvIGVhY2ggY2FyZCBoYXMgdGhlIG5ldyBpY29uLlxyXG4qL1xyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsImxvZ29JbWFnZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJhdmF0YXJJbWFnZSIsInBlbmNpbEljb25JbWFnZSIsInBsdXNJY29uSW1hZ2UiLCJzcmMiLCJsb2dvU3JjIiwiYXZhdGFyU3JjIiwicGVuY2lsSWNvblNyYyIsInBsdXNJY29uU3JjIiwicHJldmlld01vZGFsIiwibW9kYWxJbWFnZSIsIm1vZGFsQ2FwdGlvbiIsImNhcmRUZW1wbGF0ZSIsImNhcmRzTGlzdCIsImdldENhcmRFbGVtZW50IiwiaW5pdGlhbENhcmQiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkRWxlbWVudEltYWdlIiwiY2FyZEVsZW1lbnRUZXh0IiwibGluayIsIm5hbWUiLCJhbHQiLCJjYXJkTGlrZUJ0biIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0b2dnbGUiLCJvcGVuTW9kYWwiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJjYXJkUmVzdWx0IiwiYXBwZW5kIiwibWFpblNlY3Rpb24iLCJtb2RhbHMiLCJjbG9zZUJ1dHRvbnMiLCJtb2RhbCIsImhhbmRsZUVzY2FwZSIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5IiwidGFyZ2V0IiwiY29udGFpbnMiLCJidXR0b24iLCJwb3B1cCIsImNsb3Nlc3QiLCJlZGl0TW9kYWwiLCJlZGl0QnRuIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzYyIsIm5ld1Byb2ZpbGVOYW1lIiwibmV3UHJvZmlsZURlc2MiLCJwcm9maWxlRm9ybSIsInJlc2V0VmFsaWRhdGlvbiIsInZhbHVlIiwiQXJyYXkiLCJmcm9tIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwicHJvZmlsZURhdGEiLCJldmVudCIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0dGVyIiwibmV3UG9zdE1vZGFsIiwibmV3UG9zdEJ0biIsInN1Ym1pdE5ld1Bvc3RGb3JtIiwiaW1hZ2VMaW5rIiwiY2FwdGlvbiIsIm5ld1Bvc3REYXRhIiwibmV3Q2FyZFJlc3VsdCIsInByZXBlbmQiLCJyZXNldCIsInN1Ym1pdE5ld1Bvc3QiXSwic291cmNlUm9vdCI6IiJ9