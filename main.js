!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.remove(r.inputErrorClass),o.textContent=""},o=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},n=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,r):(t.classList.remove(r.inactiveButtonClass),t.disabled=!1)};var s=e+"80804e27ce061efd1ffb.svg",a=e+"2fc47fd8e9a9bcd9612f.jpg",c=e+"3f562ce83766a824571e.svg",l=e+"975792ea68af0a3c209d.svg";function i(e,t){const r=e.submitter,o=r.textContent,n=`${o.substring(0,o.length-1)}ing...`;return r.textContent=t?n:o}const d=document.getElementById("image-logo"),u=document.getElementById("image-avatar"),m=document.getElementById("image-pencil_icon"),_=document.getElementById("image-plus_icon");d.src=s,u.src=a,m.src=c,_.src=l;const f=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}postNewCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}editAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"c9851f90-cf8f-4cb2-ba1b-6a2d14bb1b1d","Content-Type":"application/json"}});let h,y;f.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{const t=g(e);q.append(t)})),I.textContent=r.name,P.textContent=r.about,w.src=r.avatar})).catch(console.error);const v=document.querySelector("#delete-modal");v.querySelector(".modal__form").addEventListener("submit",(function(e){f.deleteCard(y).then((()=>{})).catch(console.error).finally((()=>{i(e,!0),setTimeout((()=>{e.submitter.textContent="Delete"}),1e3)})),e.target.reset(),e.preventDefault(),h.remove(),x(v)}));const b=document.querySelector("#preview-modal"),p=(b.querySelector(".modal__close-btn"),b.querySelector(".modal__image")),S=b.querySelector(".modal__caption"),E=document.querySelector("#post-template"),q=document.querySelector(".posts__list");function g(e){const t=E.content.querySelector(".post").cloneNode(!0),r=t.querySelector(".post__image"),o=t.querySelector(".post__text");r.src=e.link,o.textContent=e.name,r.alt=e.name;const n=t.querySelector(".post__like-btn");return e.isLiked&&n.classList.toggle("post__like-btn_clicked"),n.addEventListener("click",(function(){const t=!!n.classList.contains("post__like-btn_clicked");f.changeLikeStatus(e._id,t).then((()=>{n.classList.toggle("post__like-btn_clicked")})).catch(console.error)})),t.querySelector(".post__delete-btn").addEventListener("click",(r=>{!function(e,t){h=e,y=t._id,$(v)}(t,e)})),r.addEventListener("click",(()=>{$(b),p.src=r.src,p.alt=r.alt,S.textContent=o.textContent})),t}document.querySelectorAll(".modal__submit-btn");const k=document.querySelector(".main"),C=[...document.querySelectorAll(".modal")],L=document.querySelectorAll(".modal__close-btn");function $(e){e.classList.remove("modal_closed"),document.addEventListener("keydown",j)}function x(e){e.classList.add("modal_closed"),document.removeEventListener("keydown",j)}function j(e){C.forEach((t=>{"Escape"===e.key&&x(t)}))}C.forEach((e=>{e.addEventListener("click",(t=>{t.target.classList.contains("modal")&&x(e)}))})),L.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>x(t)))}));const U=document.querySelector("#edit-modal"),A=document.querySelector(".profile__edit-btn"),I=(U.querySelector(".modal__close-btn"),k.querySelector(".profile__name")),P=k.querySelector(".profile__description"),T=U.querySelector("#profile-name-input"),B=U.querySelector("#profile-description-input"),D=U.querySelector(".modal__form"),w=document.querySelector(".profile__image"),N=document.querySelector(".profile__avatar-btn"),O=document.querySelector("#avatar-modal"),J=O.querySelector(".modal__form"),H=O.querySelector("#edit-avatar-input");var z;N.addEventListener("click",(()=>{$(O)})),J.addEventListener("submit",(e=>{!function(e){f.editAvatar(H.value).then((e=>{u.src=e.avatar})).catch(console.error).finally((()=>{i(e,!0),setTimeout((()=>{e.submitter.textContent="Save"}),1e3)})),o(e.submitter,t),e.target.reset(),e.preventDefault(),x(O)}(e)})),A.addEventListener("click",(()=>{var e,o;T.value=I.textContent,B.value=P.textContent,$(U),e=U,o=t,[T,B].forEach((t=>{r(e,t,o)}))})),z=t,Array.from(document.querySelectorAll(z.formSelector)).forEach((e=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),s=e.querySelector(t.submitButtonSelector);n(o,s,t),o.forEach((a=>{a.addEventListener("input",(function(){n(o,s,t),((e,t,o)=>{t.validity.valid?r(e,t,o):((e,t,r,o)=>{const n=e.querySelector(`#${t.id}-error`);t.classList.add(o.inputErrorClass),n.textContent=r})(e,t,t.validationMessage,o)})(e,a,t)}))}))})(e,z)})),D.addEventListener("submit",(e=>{var r;r=e,f.editUserInfo({name:T.value,about:B.value}).then((e=>{I.textContent=e.name,P.textContent=e.about})).catch(console.error).finally((()=>{i(r,!0),setTimeout((()=>{r.submitter.textContent="Save"}),1e3)})),o(r.submitter,t),r.preventDefault(),x(U)}));const M=document.querySelector("#post-modal"),F=document.querySelector(".profile__post-btn"),G=(M.querySelector(".modal__close-btn"),M.querySelector(".modal__form")),K=M.querySelector("#image-link"),Q=M.querySelector("#caption");F.addEventListener("click",(()=>{$(M)})),G.addEventListener("submit",(e=>{!function(e){f.postNewCard({name:Q.value,link:K.value}).then((e=>{const t=g(e);q.prepend(t)})).catch(console.error).finally((()=>{i(e,!0),setTimeout((()=>{e.submitter.textContent="Save"}),1e3)})),o(e.submitter,t),e.target.reset(),e.preventDefault(),x(M)}(e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TyxHQUNyQkUsWUFBVyxLQUNURixFQUFNdEUsVUFBVWYsWUFBYyxNQUFNLEdBQ25DLElBQUssSUFFWkMsRUFBY29GLEVBQU10RSxVQUFXL0IsR0FDL0JxRyxFQUFNSyxpQkFDTkMsRUFBVytCLEVBS21CLElBSWhDLE1BQU1vQixFQUFlekgsU0FBU3pCLGNBQWMsZUFDdENtSixFQUFhMUgsU0FBU3pCLGNBQWMsc0JBRXBDb0osR0FEdUJGLEVBQWFsSixjQUFjLHFCQUM5QmtKLEVBQWFsSixjQUFjLGlCQUMvQ3FKLEVBQVlILEVBQWFsSixjQUFjLGVBQ3ZDc0osRUFBVUosRUFBYWxKLGNBQWMsWUFFM0NtSixFQUFXM0QsaUJBQWlCLFNBQVMsS0FDbkN5QixFQUFVaUMsRUFBYSxJQXVCekJFLEVBQWtCNUQsaUJBQWlCLFVBQVdDLEtBcEI5QyxTQUF1QkEsR0FDckJ0RCxFQUNHNEIsWUFBWSxDQUFFTixLQUFNNkYsRUFBUWYsTUFBT3RFLEtBQU1vRixFQUFVZCxRQUNuRHRGLE1BQU1tRCxJQUNMLE1BQU1tRCxFQUFnQnpFLEVBQWVzQixHQUNyQ3JCLEVBQVV5RSxRQUFRRCxFQUFjLElBRWpDbkUsTUFBTUMsUUFBUUMsT0FDZEksU0FBUSxLQUNQM0UsRUFBYzBFLEdBQU8sR0FDckJFLFlBQVcsS0FDVEYsRUFBTXRFLFVBQVVmLFlBQWMsTUFBTSxHQUNuQyxJQUFLLElBRVpDLEVBQWNvRixFQUFNdEUsVUFBVy9CLEdBQy9CcUcsRUFBTUcsT0FBT0MsUUFDYkosRUFBTUssaUJBQ05DLEVBQVdtRCxFQUNiLENBR0VPLENBQWNoRSxFQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9IZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvQ29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idG5fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxyXG59O1xyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgLy8gY29uc29sZS5sb2coY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIC8vIGNvbnNvbGUubG9nKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKFxyXG4gICAgICBmb3JtRWxlbWVudCxcclxuICAgICAgaW5wdXRFbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsXHJcbiAgICAgIGNvbmZpZ1xyXG4gICAgKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XHJcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAvLyBjb25zb2xlLmxvZyhjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIC8vICAgY29uc29sZS5sb2coaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpO1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWxlbWVudCwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxyXG4gICk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIC8vIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgLy8gICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIC8vIH0pO1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vLyBlbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcclxuXHJcbmV4cG9ydCB7IHNldHRpbmdzLCBlbmFibGVWYWxpZGF0aW9uLCByZXNldFZhbGlkYXRpb24gfTtcclxuIiwiZXhwb3J0IGZ1bmN0aW9uIHNldEJ1dHRvblRleHQoYnRuLCBpc0xvYWRpbmcpIHtcclxuICBjb25zdCBzdWJtaXRCdG4gPSBidG4uc3VibWl0dGVyO1xyXG4gIGNvbnN0IGJ0blRleHQgPSBzdWJtaXRCdG4udGV4dENvbnRlbnQ7XHJcbiAgY29uc3QgYnRuVGV4dExvYWRpbmcgPSBgJHtidG5UZXh0LnN1YnN0cmluZygwLCBidG5UZXh0Lmxlbmd0aCAtIDEpfWluZy4uLmA7XHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgcmV0dXJuIChzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBidG5UZXh0TG9hZGluZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiAoc3VibWl0QnRuLnRleHRDb250ZW50ID0gYnRuVGV4dCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYWwgVGhvcmVuc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgIG5hbWU6IFwiUmVzdGF1cmFudCB0ZXJyYWNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgIG5hbWU6IFwiQW4gb3V0ZG9vciBjYWZlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgIG5hbWU6IFwiQSB2ZXJ5IGxvbmcgYnJpZGdlLCBvdmVyIHRoZSBmb3Jlc3QgYW5kIHRocm91Z2ggdGhlIHRyZWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbmFtZTogXCJUdW5uZWwgd2l0aCBtb3JuaW5nIGxpZ2h0XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICBuYW1lOiBcIk1vdW50YWluIGhvdXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBCcmlkZ2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy83LXBob3RvLWJ5LWdyaWZmaW4td29vbGRyaWRnZS1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG5dO1xyXG4iLCIvL0FERCBGQUtFIENPTU1FTlQgRk9SIFBST0pFQ1QgOSBCUkFOQ0hcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICBzZXR0aW5ncyxcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIHJlc2V0VmFsaWRhdGlvbixcclxuICBkaXNhYmxlQnV0dG9uLFxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcclxuaW1wb3J0IHsgQXBpIH0gZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xyXG5cclxuaW1wb3J0IGxvZ29TcmMgZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xyXG5pbXBvcnQgYXZhdGFyU3JjIGZyb20gXCIuLi9pbWFnZXMvYXZhdGFyLmpwZ1wiO1xyXG5pbXBvcnQgcGVuY2lsSWNvblNyYyBmcm9tIFwiLi4vaW1hZ2VzL3BlbmNpbF9pY29uLnN2Z1wiO1xyXG5pbXBvcnQgcGx1c0ljb25TcmMgZnJvbSBcIi4uL2ltYWdlcy9wbHVzX2ljb24uc3ZnXCI7XHJcbmltcG9ydCB7IHNldEJ1dHRvblRleHQgfSBmcm9tIFwiLi4vdXRpbHMvSGVscGVycy5qc1wiO1xyXG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMgfSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzLmpzXCI7XHJcblxyXG5jb25zdCBsb2dvSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLWxvZ29cIik7XHJcbmNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbWFnZS1hdmF0YXJcIik7XHJcbmNvbnN0IHBlbmNpbEljb25JbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2UtcGVuY2lsX2ljb25cIik7XHJcbmNvbnN0IHBsdXNJY29uSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLXBsdXNfaWNvblwiKTtcclxuXHJcbmxvZ29JbWFnZS5zcmMgPSBsb2dvU3JjO1xyXG5hdmF0YXJJbWFnZS5zcmMgPSBhdmF0YXJTcmM7XHJcbnBlbmNpbEljb25JbWFnZS5zcmMgPSBwZW5jaWxJY29uU3JjO1xyXG5wbHVzSWNvbkltYWdlLnNyYyA9IHBsdXNJY29uU3JjO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiYzk4NTFmOTAtY2Y4Zi00Y2IyLWJhMWItNmEyZDE0YmIxYjFkXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmFwaVxyXG4gIC5nZXRBcHBJbmZvKClcclxuICAudGhlbigoW2NhcmRzLCBoZWFkZXJzXSkgPT4ge1xyXG4gICAgY2FyZHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkUmVzdWx0ID0gZ2V0Q2FyZEVsZW1lbnQoZWxlbWVudCk7XHJcbiAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZFJlc3VsdCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBIYW5kbGUgdGhlIHVzZXIncyBpbmZvXHJcbiAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGhlYWRlcnMubmFtZTtcclxuICAgIHByb2ZpbGVEZXNjLnRleHRDb250ZW50ID0gaGVhZGVycy5hYm91dDtcclxuICAgIHByb2ZpbGVJbWFnZS5zcmMgPSBoZWFkZXJzLmF2YXRhcjtcclxuICB9KVxyXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09IERFTEVURSBBIFBPU1QgTU9EQUwgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxubGV0IHNlbGVjdGVkQ2FyZDtcclxubGV0IHNlbGVjdGVkQ2FyZElkO1xyXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xyXG5jb25zdCBkZWxldGVGb3JtID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpIHtcclxuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcclxuICBzZWxlY3RlZENhcmRJZCA9IGRhdGEuX2lkO1xyXG4gIG9wZW5Nb2RhbChkZWxldGVNb2RhbCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldmVudCkge1xyXG4gIGFwaVxyXG4gICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpIC8vIHBhc3MgdGhlIElEIHRoZSB0aGUgYXBpIGZ1bmN0aW9uXHJcbiAgICAudGhlbigoKSA9PiB7fSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KGV2ZW50LCB0cnVlKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgZXZlbnQuc3VibWl0dGVyLnRleHRDb250ZW50ID0gXCJEZWxldGVcIjtcclxuICAgICAgfSwgMTAwMCk7XHJcbiAgICB9KTtcclxuICAvLyBkaXNhYmxlQnV0dG9uKGV2ZW50LnN1Ym1pdHRlciwgc2V0dGluZ3MpO1xyXG4gIGV2ZW50LnRhcmdldC5yZXNldCgpO1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgLy8gcmVtb3ZlIHRoZSBjYXJkIGZyb20gdGhlIERPTVxyXG4gIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcclxuICAvLyBjbG9zZSB0aGUgbW9kYWxcclxuICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufVxyXG5cclxuZGVsZXRlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBQUkVWSUVXIFtJTUFHRV0gTU9EQUwgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IG1vZGFsSW1hZ2UgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmNvbnN0IG1vZGFsQ2FwdGlvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gTE9BRCBQT1NUUyBPTlRPIFBBR0UgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3N0LXRlbXBsYXRlXCIpO1xyXG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvc3RzX19saXN0XCIpO1xyXG5jb25zdCBtb2RhbFN1Ym1pdEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcclxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBvc3RcIilcclxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gIC8vIHNlbGVjdCB0aGUgY2FyZCB0aXRsZSBhbmQgaW1hZ2UgYW5kIHN0b3JlIHRoZW0gaW4gdmFyaWFibGVzXHJcbiAgLy8gc2V0IHRoZSBpbWFnZeKAmXMgc3JjIGF0dHJpYnV0ZSB0byB0aGUgaW1hZ2UgdG8gdGhlIGxpbmsgZmllbGQgb2YgdGhlIG9iamVjdFxyXG4gIGNvbnN0IGNhcmRFbGVtZW50SW1hZ2UgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvc3RfX2ltYWdlXCIpO1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50VGV4dCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9zdF9fdGV4dFwiKTtcclxuXHJcbiAgLy8gc2V0IHRoZSBpbWFnZeKAmXMgc3JjIGF0dHJpYnV0ZSB0byB0aGUgaW1hZ2UgdG8gdGhlIGxpbmsgZmllbGQgb2YgdGhlIG9iamVjdFxyXG4gIC8vIHNldCB0aGUgaW1hZ2XigJlzIGFsdCB0ZXh0IHRvIHRoZSBuYW1lIGZpZWxkIG9mIHRoZSBvYmplY3RcclxuICAvLyBzZXQgdGhlIGNhcmTigJlzIHRpdGxlIHRvIHRoZSBuYW1lIGZpZWxkIG9mIHRoZSBvYmplY3QsIHRvb1xyXG4gIGNhcmRFbGVtZW50SW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRFbGVtZW50VGV4dC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBjYXJkRWxlbWVudEltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuXHJcbiAgLy8gTGlrZSBCdXR0b25zIG9uIEVhY2ggUG9zdFxyXG4gIGNvbnN0IGNhcmRMaWtlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3N0X19saWtlLWJ0blwiKTtcclxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XHJcbiAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwicG9zdF9fbGlrZS1idG5fY2xpY2tlZFwiKTtcclxuICB9XHJcbiAgLy9GdW5jdGlvbiB0byBjaGFuZ2UgQ1NTIG9uICdoZWFydC1zaGFwZWQnIExpa2UgSWNvbiBmb3IgZWFjaCBwb3N0LlxyXG4gIGZ1bmN0aW9uIGhhbmRsZUxpa2VJY29uKCkge1xyXG4gICAgY29uc3QgaXNMaWtlZENsYXNzID0gY2FyZExpa2VCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKFxyXG4gICAgICBcInBvc3RfX2xpa2UtYnRuX2NsaWNrZWRcIlxyXG4gICAgKVxyXG4gICAgICA/IHRydWVcclxuICAgICAgOiBmYWxzZTtcclxuICAgIGFwaVxyXG4gICAgICAuY2hhbmdlTGlrZVN0YXR1cyhkYXRhLl9pZCwgaXNMaWtlZENsYXNzKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LnRvZ2dsZShcInBvc3RfX2xpa2UtYnRuX2NsaWNrZWRcIik7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuICB9XHJcblxyXG4gIGNhcmRMaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVMaWtlSWNvbik7XHJcblxyXG4gIC8vTWFrZSBUcmFzaCBDYW4gaWNvbiBkZWxldGUgdGhlIHJlc3BlY3RpdmUgcG9zdC5cclxuICBjb25zdCBwb3N0RGVsZXRlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3N0X19kZWxldGUtYnRuXCIpOyAvLyBNQVkgTkVFRCBUTyBDSEFOR0UgV0hFUkUgVEhFIFFVRVJZIFNFTEVDVE9SIFNUQVJUU1xyXG4gIHBvc3REZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpO1xyXG4gIH0pO1xyXG5cclxuICAvL0NsaWNrIEV2ZW50IGFueXdoZXJlIG9uIHRoZSBwb3N0X19pbWFnZSB3aWxsIG9wZW4gdGhlIHByZXZpZXctbW9kYWwgdG8gYmV0dGVyIHZpZXcgdGhlIHBpY3R1cmUuXHJcbiAgY2FyZEVsZW1lbnRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbiAgICBtb2RhbEltYWdlLnNyYyA9IGNhcmRFbGVtZW50SW1hZ2Uuc3JjO1xyXG4gICAgbW9kYWxJbWFnZS5hbHQgPSBjYXJkRWxlbWVudEltYWdlLmFsdDtcclxuICAgIG1vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IGNhcmRFbGVtZW50VGV4dC50ZXh0Q29udGVudDtcclxuICAgIC8vIGNvbnNvbGUubG9nKHByZXZpZXdNb2RhbC5jbGFzc0xpc3QpO1xyXG4gIH0pO1xyXG5cclxuICAvLyByZXR1cm4gdGhlIHJlYWR5IEhUTUwgZWxlbWVudCB3aXRoIHRoZSBmaWxsZWQtaW4gZGF0YVxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gQUxMIE1PREFMUyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5jb25zdCBtYWluU2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpblwiKTtcclxuY29uc3QgbW9kYWxzID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIildO1xyXG5jb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfY2xvc2VkXCIpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XHJcbiAgLy8gY29uc29sZS5sb2cobW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfY2xvc2VkXCIpO1xyXG4gIC8vIGNvbnNvbGUubG9nKG1vZGFsKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XHJcbiAgbW9kYWxzLmZvckVhY2goKG1vZGFsKSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICBjbG9zZU1vZGFsKG1vZGFsKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxubW9kYWxzLmZvckVhY2goKG1vZGFsKSA9PiB7XHJcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XHJcbiAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KTtcclxuXHJcbmNsb3NlQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcclxuICBjb25zdCBwb3B1cCA9IGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpO1xyXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChwb3B1cCkpO1xyXG59KTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09IEVESVQgUFJPRklMRSBNT0RBTCA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbW9kYWxcIik7XHJcbmNvbnN0IGVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xyXG5jb25zdCBlZGl0TW9kYWxDbG9zZUJ0biA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gbWFpblNlY3Rpb24ucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzYyA9IG1haW5TZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcbmNvbnN0IG5ld1Byb2ZpbGVOYW1lID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBuZXdQcm9maWxlRGVzYyA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbmNvbnN0IGVkaXRQcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idG5cIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XHJcbmNvbnN0IGF2YXRhckZvcm0gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBhdmF0YXJJbnB1dCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1hdmF0YXItaW5wdXRcIik7XHJcblxyXG5lZGl0UHJvZmlsZUltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKGF2YXRhck1vZGFsKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBzdWJtaXRBdmF0YXJFZGl0KGV2ZW50KSB7XHJcbiAgYXBpXHJcbiAgICAuZWRpdEF2YXRhcihhdmF0YXJJbnB1dC52YWx1ZSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGF2YXRhckltYWdlLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KGV2ZW50LCB0cnVlKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgZXZlbnQuc3VibWl0dGVyLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICAgIH0sIDEwMDApO1xyXG4gICAgfSk7XHJcbiAgZGlzYWJsZUJ1dHRvbihldmVudC5zdWJtaXR0ZXIsIHNldHRpbmdzKTtcclxuICBldmVudC50YXJnZXQucmVzZXQoKTtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59XHJcblxyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgc3VibWl0QXZhdGFyRWRpdChldmVudCk7XHJcbn0pO1xyXG5cclxuZWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG5ld1Byb2ZpbGVOYW1lLnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgbmV3UHJvZmlsZURlc2MudmFsdWUgPSBwcm9maWxlRGVzYy50ZXh0Q29udGVudDtcclxuICBvcGVuTW9kYWwoZWRpdE1vZGFsKTtcclxuICByZXNldFZhbGlkYXRpb24oZWRpdE1vZGFsLCBbbmV3UHJvZmlsZU5hbWUsIG5ld1Byb2ZpbGVEZXNjXSwgc2V0dGluZ3MpO1xyXG59KTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG5cclxuZnVuY3Rpb24gc3VibWl0UHJvZmlsZUZvcm0oZXZlbnQpIHtcclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8oeyBuYW1lOiBuZXdQcm9maWxlTmFtZS52YWx1ZSwgYWJvdXQ6IG5ld1Byb2ZpbGVEZXNjLnZhbHVlIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAvLyBkdGEgYXJnIGluc3RlYWQgb2YgaW5wdXQgdmFsdWVzLlxyXG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgICAgcHJvZmlsZURlc2MudGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KGV2ZW50LCB0cnVlKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgZXZlbnQuc3VibWl0dGVyLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICAgIH0sIDEwMDApO1xyXG4gICAgfSk7XHJcbiAgZGlzYWJsZUJ1dHRvbihldmVudC5zdWJtaXR0ZXIsIHNldHRpbmdzKTtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcclxuICAvLyBkaXNhYmxlQnV0dG9uKG1vZGFsU3VibWl0QnRucyk7XHJcbn1cclxuXHJcbnByb2ZpbGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKHByb2ZpbGVEYXRhKSA9PiB7XHJcbiAgc3VibWl0UHJvZmlsZUZvcm0ocHJvZmlsZURhdGEpO1xyXG59KTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09IE5FVyBQT1NUIE1PREFMID09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9zdC1tb2RhbFwiKTtcclxuY29uc3QgbmV3UG9zdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcG9zdC1idG5cIik7XHJcbmNvbnN0IG5ld1Bvc3RNb2RhbENsb3NlQnRuID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuY29uc3Qgc3VibWl0TmV3UG9zdEZvcm0gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgaW1hZ2VMaW5rID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2UtbGlua1wiKTtcclxuY29uc3QgY2FwdGlvbiA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2NhcHRpb25cIik7XHJcblxyXG5uZXdQb3N0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKG5ld1Bvc3RNb2RhbCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gc3VibWl0TmV3UG9zdChldmVudCkge1xyXG4gIGFwaVxyXG4gICAgLnBvc3ROZXdDYXJkKHsgbmFtZTogY2FwdGlvbi52YWx1ZSwgbGluazogaW1hZ2VMaW5rLnZhbHVlIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBuZXdDYXJkUmVzdWx0ID0gZ2V0Q2FyZEVsZW1lbnQoZGF0YSk7XHJcbiAgICAgIGNhcmRzTGlzdC5wcmVwZW5kKG5ld0NhcmRSZXN1bHQpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KGV2ZW50LCB0cnVlKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgZXZlbnQuc3VibWl0dGVyLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICAgIH0sIDEwMDApO1xyXG4gICAgfSk7XHJcbiAgZGlzYWJsZUJ1dHRvbihldmVudC5zdWJtaXR0ZXIsIHNldHRpbmdzKTtcclxuICBldmVudC50YXJnZXQucmVzZXQoKTtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcclxufVxyXG5cclxuc3VibWl0TmV3UG9zdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICBzdWJtaXROZXdQb3N0KGV2ZW50KTtcclxuICAvLyBMaW5rIHRvIGFuIGltYWdlIGZvcm0gdW5zcGxhc2guY29tIHRoYXQgSSB1c2VkIHRvIGVuc3VyZSBldmVyeXRoaW5nIHdvcmtzIHByb3Blcmx5OlxyXG4gIC8vIGh0dHBzOi8vcGx1cy51bnNwbGFzaC5jb20vcHJlbWl1bV9waG90by0xNzM0NTQzOTQyODM2LTNmOWEwYzMxM2RhND93PTUwMCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZxPTYwJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4bVpXRjBkWEpsWkMxd2FHOTBiM010Wm1WbFpId3hmSHg4Wlc1OE1IeDhmSHg4XHJcbn0pO1xyXG4iLCJleHBvcnQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICAvL2NhbGwgZ2V0VXNlckluZm8gaW4gdGhpcyBhcnJheVxyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIENyZWF0ZSBhbm90aGVyIG1ldGhvZCwgZ2V0VXNlckluZm8gKGRpZmZlcmVudCBiYXNlIHVybClcclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIFNlbmRzIFVzZXIgaW5mbyBlZGl0ZWQgYnkgdXNlciB0byB0aGUgc2VydmVyXHJcbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgLy8gU2VuZCB0aGUgZGF0YSBpbiB0aGUgYm9keSBhcyBhIEpTT04gc3RyaW5nLlxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQb3N0IGEgbmV3IGltYWdlIChjYXJkKSB0byB0aGUgcGFnZVxyXG4gIHBvc3ROZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIC8vIFNlbmQgdGhlIGRhdGEgaW4gdGhlIGJvZHkgYXMgYSBKU09OIHN0cmluZy5cclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8vIERlbGV0ZSBhbiBpbWFnZSAoY2FyZCkgZnJvbSB0aGUgcGFnZVxyXG4gIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gQ2hhbmdlIHRoZSBzdGF0dXMgb2YgdGhlICdMaWtlJyBoZWFydC1zaGFwZWQgaWNvblxyXG4gIGNoYW5nZUxpa2VTdGF0dXMoaWQsIGlzTGlrZWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBTZW5kcyBVc2VyIGluZm8gZWRpdGVkIGJ5IHVzZXIgdG8gdGhlIHNlcnZlclxyXG4gIGVkaXRBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgLy8gU2VuZCB0aGUgZGF0YSBpbiB0aGUgYm9keSBhcyBhIEpTT04gc3RyaW5nLlxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImNvbmZpZyIsImVycm9yRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRleHRDb250ZW50IiwiZGlzYWJsZUJ1dHRvbiIsImJ1dHRvbkVsZW1lbnQiLCJkaXNhYmxlZCIsImFkZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJzZXRCdXR0b25UZXh0IiwiYnRuIiwiaXNMb2FkaW5nIiwic3VibWl0QnRuIiwic3VibWl0dGVyIiwiYnRuVGV4dCIsImJ0blRleHRMb2FkaW5nIiwic3Vic3RyaW5nIiwibGVuZ3RoIiwibG9nb0ltYWdlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImF2YXRhckltYWdlIiwicGVuY2lsSWNvbkltYWdlIiwicGx1c0ljb25JbWFnZSIsInNyYyIsImxvZ29TcmMiLCJhdmF0YXJTcmMiLCJwZW5jaWxJY29uU3JjIiwicGx1c0ljb25TcmMiLCJhcGkiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0QXBwSW5mbyIsIlByb21pc2UiLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImVkaXRVc2VySW5mbyIsIl9yZWYyIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwb3N0TmV3Q2FyZCIsIl9yZWYzIiwibGluayIsImRlbGV0ZUNhcmQiLCJjaGFuZ2VMaWtlU3RhdHVzIiwiaXNMaWtlZCIsImVkaXRBdmF0YXIiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJjYXJkcyIsImZvckVhY2giLCJlbGVtZW50IiwiY2FyZFJlc3VsdCIsImdldENhcmRFbGVtZW50IiwiY2FyZHNMaXN0IiwiYXBwZW5kIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzYyIsInByb2ZpbGVJbWFnZSIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiZGVsZXRlTW9kYWwiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJmaW5hbGx5Iiwic2V0VGltZW91dCIsInRhcmdldCIsInJlc2V0IiwicHJldmVudERlZmF1bHQiLCJjbG9zZU1vZGFsIiwicHJldmlld01vZGFsIiwibW9kYWxJbWFnZSIsIm1vZGFsQ2FwdGlvbiIsImNhcmRUZW1wbGF0ZSIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkRWxlbWVudEltYWdlIiwiY2FyZEVsZW1lbnRUZXh0IiwiYWx0IiwiY2FyZExpa2VCdG4iLCJ0b2dnbGUiLCJpc0xpa2VkQ2xhc3MiLCJjb250YWlucyIsIl9pZCIsImV2dCIsIm9wZW5Nb2RhbCIsImhhbmRsZURlbGV0ZUNhcmQiLCJxdWVyeVNlbGVjdG9yQWxsIiwibWFpblNlY3Rpb24iLCJtb2RhbHMiLCJjbG9zZUJ1dHRvbnMiLCJtb2RhbCIsImhhbmRsZUVzY2FwZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJidXR0b24iLCJwb3B1cCIsImNsb3Nlc3QiLCJlZGl0TW9kYWwiLCJlZGl0QnRuIiwibmV3UHJvZmlsZU5hbWUiLCJuZXdQcm9maWxlRGVzYyIsInByb2ZpbGVGb3JtIiwiZWRpdFByb2ZpbGVJbWFnZSIsImF2YXRhck1vZGFsIiwiYXZhdGFyRm9ybSIsImF2YXRhcklucHV0IiwidmFsdWUiLCJzdWJtaXRBdmF0YXJFZGl0IiwicmVzZXRWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwicHJvZmlsZURhdGEiLCJuZXdQb3N0TW9kYWwiLCJuZXdQb3N0QnRuIiwic3VibWl0TmV3UG9zdEZvcm0iLCJpbWFnZUxpbmsiLCJjYXB0aW9uIiwibmV3Q2FyZFJlc3VsdCIsInByZXBlbmQiLCJzdWJtaXROZXdQb3N0Il0sInNvdXJjZVJvb3QiOiIifQ==